// DescendView.js Copyright (c) 2014 John Cardinal (John@JohnCardinal.com)
;(function($){$.extend($.fn,{swapClass:function(c1,c2){var c1Elements=this.filter('.'+c1);this.filter('.'+c2).removeClass(c2).addClass(c1);c1Elements.removeClass(c1).addClass(c2);return this;},heightToggle:function(animated,callback){animated?this.animate({height:"toggle"},animated,callback):this.each(function(){jQuery(this)[jQuery(this).is(":hidden")?"show":"hide"]();if(callback)
callback.apply(this,arguments);});return this;},descendView:function(settings){var CLASSES={expandable:"dv-expandable",collapsible:"dv-collapsible",lastcollapsible:"dv-last-collapsible",lastExpandable:"dv-last-expandable",last:"dv-last",hitarea:"dv-hitarea"},isDynamic=true;function prepareItems(list){var nItems=list.length;var iItem=0;list.each(function(){var sItemLast='';iItem++;if($(this).children('ul').length>0){if(iItem==nItems){sItemLast=' '+CLASSES.lastcollapsible;};$(this).addClass(CLASSES.collapsible+sItemLast);if(isDynamic){$(this).prepend('<div class="'+CLASSES.hitarea+'"/>');}else if(iItem==nItems){$(this).addClass(CLASSES.last);};prepareItems($(this).children('ul').children('li'));}else{if(iItem==nItems)$(this).addClass(CLASSES.last);};});};function collapseAll(tree){$('ul',tree).hide();$('li.'+CLASSES.collapsible,tree).toggleClass(CLASSES.collapsible+' '+CLASSES.expandable);$('li.'+CLASSES.lastcollapsible,tree).toggleClass(CLASSES.lastcollapsible+' '+CLASSES.lastExpandable);};function expandAll(tree){$('li.'+CLASSES.expandable,tree).toggleClass(CLASSES.expandable+' '+CLASSES.collapsible);$('li.'+CLASSES.lastExpandable,tree).toggleClass(CLASSES.lastExpandable+' '+CLASSES.lastcollapsible);$('ul',tree).show();};function treeController(tree,control){$(":eq(0)",control).click(function(){collapseAll(tree);});$(":eq(1)",control).click(function(){expandAll(tree);});};function toggler(){$(this).parent().swapClass(CLASSES.collapsible,CLASSES.expandable).swapClass(CLASSES.lastcollapsible,CLASSES.lastExpandable).find('>ul').heightToggle(settings.animated);};function assignHandlers(tree){$(tree).on('click','div.'+CLASSES.hitarea,toggler);};this.addClass("descendview");prepareItems($(this).children('li'));assignHandlers(this);if(isDynamic){if(settings.control){treeController(this,settings.control);$(settings.control).show();};if(settings.collapse){collapseAll(this);};};return this;}});})(jQuery);